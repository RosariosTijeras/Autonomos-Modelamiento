library(dplyr)
library(tidyr)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(caret)

df <- read.csv("credit_score.csv")
glimpse(df)
summary(df)
colnames(df) <- c("Edad","Genero","Ingresos","Educacion","Estado_civil","Hijos","Predio","Puntaje")
df$Genero <- factor(df$Genero)
df$Estado_civil <- factor(df$Estado_civil)
df$Predio <- factor(df$Predio)

library(stringr)
df$Educacion <- str_replace(df$Educacion,"'s Degree","")
df$Educacion <- str_replace(df$Educacion," Diploma","")
df$Educacion <- factor(df$Educacion,levels = c("High School","Associate","Bachelor","Master","Doctorate"))
glimpse(df)
summary(df)

plot(df$Edad,df$Ingresos)
plot(df$Edad,df$Puntaje)
plot(df$Ingresos,df$Puntaje)
df$credit_score <- cut(df$Puntaje,breaks=c(-Inf,70,85,+Inf),labels =c("Slow","Medium","High"),ordered_result = T )


ggplot(df,aes(x=credit_score,y=Ingresos,fill=credit_score))+geom_boxplot()

